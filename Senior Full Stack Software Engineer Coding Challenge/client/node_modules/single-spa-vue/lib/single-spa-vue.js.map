{"version":3,"file":"single-spa-vue.js","sources":["../node_modules/css.escape/css.escape.js","../src/single-spa-vue.js"],"sourcesContent":["/*! https://mths.be/cssescape v1.5.1 by @mathias | MIT license */\n;(function(root, factory) {\n\t// https://github.com/umdjs/umd/blob/master/returnExports.js\n\tif (typeof exports == 'object') {\n\t\t// For Node.js.\n\t\tmodule.exports = factory(root);\n\t} else if (typeof define == 'function' && define.amd) {\n\t\t// For AMD. Register as an anonymous module.\n\t\tdefine([], factory.bind(root, root));\n\t} else {\n\t\t// For browser globals (not exposing the function separately).\n\t\tfactory(root);\n\t}\n}(typeof global != 'undefined' ? global : this, function(root) {\n\n\tif (root.CSS && root.CSS.escape) {\n\t\treturn root.CSS.escape;\n\t}\n\n\t// https://drafts.csswg.org/cssom/#serialize-an-identifier\n\tvar cssEscape = function(value) {\n\t\tif (arguments.length == 0) {\n\t\t\tthrow new TypeError('`CSS.escape` requires an argument.');\n\t\t}\n\t\tvar string = String(value);\n\t\tvar length = string.length;\n\t\tvar index = -1;\n\t\tvar codeUnit;\n\t\tvar result = '';\n\t\tvar firstCodeUnit = string.charCodeAt(0);\n\t\twhile (++index < length) {\n\t\t\tcodeUnit = string.charCodeAt(index);\n\t\t\t// Note: there’s no need to special-case astral symbols, surrogate\n\t\t\t// pairs, or lone surrogates.\n\n\t\t\t// If the character is NULL (U+0000), then the REPLACEMENT CHARACTER\n\t\t\t// (U+FFFD).\n\t\t\tif (codeUnit == 0x0000) {\n\t\t\t\tresult += '\\uFFFD';\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tif (\n\t\t\t\t// If the character is in the range [\\1-\\1F] (U+0001 to U+001F) or is\n\t\t\t\t// U+007F, […]\n\t\t\t\t(codeUnit >= 0x0001 && codeUnit <= 0x001F) || codeUnit == 0x007F ||\n\t\t\t\t// If the character is the first character and is in the range [0-9]\n\t\t\t\t// (U+0030 to U+0039), […]\n\t\t\t\t(index == 0 && codeUnit >= 0x0030 && codeUnit <= 0x0039) ||\n\t\t\t\t// If the character is the second character and is in the range [0-9]\n\t\t\t\t// (U+0030 to U+0039) and the first character is a `-` (U+002D), […]\n\t\t\t\t(\n\t\t\t\t\tindex == 1 &&\n\t\t\t\t\tcodeUnit >= 0x0030 && codeUnit <= 0x0039 &&\n\t\t\t\t\tfirstCodeUnit == 0x002D\n\t\t\t\t)\n\t\t\t) {\n\t\t\t\t// https://drafts.csswg.org/cssom/#escape-a-character-as-code-point\n\t\t\t\tresult += '\\\\' + codeUnit.toString(16) + ' ';\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tif (\n\t\t\t\t// If the character is the first character and is a `-` (U+002D), and\n\t\t\t\t// there is no second character, […]\n\t\t\t\tindex == 0 &&\n\t\t\t\tlength == 1 &&\n\t\t\t\tcodeUnit == 0x002D\n\t\t\t) {\n\t\t\t\tresult += '\\\\' + string.charAt(index);\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\t// If the character is not handled by one of the above rules and is\n\t\t\t// greater than or equal to U+0080, is `-` (U+002D) or `_` (U+005F), or\n\t\t\t// is in one of the ranges [0-9] (U+0030 to U+0039), [A-Z] (U+0041 to\n\t\t\t// U+005A), or [a-z] (U+0061 to U+007A), […]\n\t\t\tif (\n\t\t\t\tcodeUnit >= 0x0080 ||\n\t\t\t\tcodeUnit == 0x002D ||\n\t\t\t\tcodeUnit == 0x005F ||\n\t\t\t\tcodeUnit >= 0x0030 && codeUnit <= 0x0039 ||\n\t\t\t\tcodeUnit >= 0x0041 && codeUnit <= 0x005A ||\n\t\t\t\tcodeUnit >= 0x0061 && codeUnit <= 0x007A\n\t\t\t) {\n\t\t\t\t// the character itself\n\t\t\t\tresult += string.charAt(index);\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\t// Otherwise, the escaped character.\n\t\t\t// https://drafts.csswg.org/cssom/#escape-a-character\n\t\t\tresult += '\\\\' + string.charAt(index);\n\n\t\t}\n\t\treturn result;\n\t};\n\n\tif (!root.CSS) {\n\t\troot.CSS = {};\n\t}\n\n\troot.CSS.escape = cssEscape;\n\treturn cssEscape;\n\n}));\n","import \"css.escape\";\n\nconst defaultOpts = {\n  // required opts\n  Vue: null,\n  appOptions: null,\n  template: null\n};\n\nexport default function singleSpaVue(userOpts) {\n  if (typeof userOpts !== \"object\") {\n    throw new Error(`single-spa-vue requires a configuration object`);\n  }\n\n  const opts = {\n    ...defaultOpts,\n    ...userOpts\n  };\n\n  if (!opts.Vue) {\n    throw new Error(\"single-spa-vuejs must be passed opts.Vue\");\n  }\n\n  if (!opts.appOptions) {\n    throw new Error(\"single-spa-vuejs must be passed opts.appOptions\");\n  }\n\n  // Just a shared object to store the mounted object state\n  let mountedInstances = {};\n\n  return {\n    bootstrap: bootstrap.bind(null, opts, mountedInstances),\n    mount: mount.bind(null, opts, mountedInstances),\n    unmount: unmount.bind(null, opts, mountedInstances),\n    update: update.bind(null, opts, mountedInstances)\n  };\n}\n\nfunction bootstrap(opts) {\n  if (opts.loadRootComponent) {\n    return opts.loadRootComponent().then(root => (opts.rootComponent = root));\n  } else {\n    return Promise.resolve();\n  }\n}\n\nfunction mount(opts, mountedInstances, props) {\n  return Promise.resolve().then(() => {\n    const appOptions = { ...opts.appOptions };\n    if (props.domElement && !appOptions.el) {\n      appOptions.el = props.domElement;\n    }\n\n    if (!appOptions.el) {\n      const htmlId = `single-spa-application:${props.name}`;\n      appOptions.el = `#${CSS.escape(htmlId)} .single-spa-container`;\n      let domEl = document.getElementById(htmlId);\n      if (!domEl) {\n        domEl = document.createElement(\"div\");\n        domEl.id = htmlId;\n        document.body.appendChild(domEl);\n      }\n\n      // single-spa-vue@>=2 always REPLACES the `el` instead of appending to it.\n      // We want domEl to stick around and not be replaced. So we tell Vue to mount\n      // into a container div inside of the main domEl\n      if (!domEl.querySelector(\".single-spa-container\")) {\n        const singleSpaContainer = document.createElement(\"div\");\n        singleSpaContainer.className = \"single-spa-container\";\n        domEl.appendChild(singleSpaContainer);\n      }\n\n      mountedInstances.domEl = domEl;\n    }\n\n    if (!appOptions.render && !appOptions.template && opts.rootComponent) {\n      appOptions.render = h => h(opts.rootComponent);\n    }\n\n    if (!appOptions.data) {\n      appOptions.data = {};\n    }\n\n    appOptions.data = { ...appOptions.data, ...props };\n\n    mountedInstances.instance = new opts.Vue(appOptions);\n    if (mountedInstances.instance.bind) {\n      mountedInstances.instance = mountedInstances.instance.bind(\n        mountedInstances.instance\n      );\n    }\n    return mountedInstances.instance;\n  });\n}\n\nfunction update(opts, mountedInstances, props) {\n  return Promise.resolve().then(() => {\n    const data = {\n      ...(opts.appOptions.data || {}),\n      ...props\n    };\n    for (let prop in data) {\n      mountedInstances.instance[prop] = data[prop];\n    }\n  });\n}\n\nfunction unmount(opts, mountedInstances) {\n  return Promise.resolve().then(() => {\n    mountedInstances.instance.$destroy();\n    mountedInstances.instance.$el.innerHTML = \"\";\n    delete mountedInstances.instance;\n\n    if (mountedInstances.domEl) {\n      mountedInstances.domEl.innerHTML = \"\";\n      delete mountedInstances.domEl;\n    }\n  });\n}\n"],"names":["root","global","module","CSS","escape","cssEscape","value","arguments","length","TypeError","codeUnit","string","String","index","result","firstCodeUnit","charCodeAt","toString","charAt","factory","defaultOpts","Vue","appOptions","template","bootstrap","opts","loadRootComponent","then","rootComponent","Promise","resolve","mount","mountedInstances","props","domElement","el","htmlId","name","domEl","document","getElementById","createElement","id","body","appendChild","querySelector","singleSpaContainer","className","render","h","data","instance","bind","update","prop","unmount","$destroy","$el","innerHTML","userOpts","_typeof","Error"],"mappings":"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"}